# Java-CVE-Lists

> 这个仓库主要用于记录一些Java生态的**CVE简要说明、利用条件**以及**相关学习文章**。值得注意的是，本仓库关注的是目前主流的Java技术中存在的历史漏洞，而不是老古董。（持续更新中...）如有建议入选漏洞，欢迎👏提出issue👀。

[TOC]

---

### Apache Xalan Java XSLT

#### [CVE-2022-34169](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34169)

##### 利用条件

> 只要有 XML xslt 转换使用场景
>
> xalan:xalan@(-∞, 2.7.2]
>
> openjdk11@(-∞, 11.0.17_p8-r0)
>
> openjdk8@(-∞, 8.345.01-r0)
>
> openjdk13@(-∞, 13.0.12_p4-r0)
>
> openjdk15@(-∞, 15.0.8_p4-r0)
>
> openjdk17@(-∞, 17.0.4_p8-r0)
>
> openjdk8@(-∞, 8.345.01-r0)
>
> openjdk11@(-∞, 11.0.16_p8-r0)
>
> openjdk13@(-∞, 13.0.12_p4-r0)
>
> openjdk15@(-∞, 15.0.8_p4-r0)
>
> openjdk17@(-∞, 17.0.4_p8-r0)
>
> openjdk8@(-∞, 8.345.01-r0)
>
> openjdk11@(-∞, 11.0.16_p8-r0)
>
> openjdk-11@(-∞, 11.0.16+8-1)
>
> openjdk-8@(-∞, 8u342-b07-1)
>
> openjdk-17@(-∞, 17.0.4+8-1)
>
> bcel@(-∞, 6.5.0-2)

##### 漏洞说明

- 把xslt转换成class的时候存在溢出，导致攻击者可以上传精心构造的恶意xslt，通过xalan转换后得到恶意的class，这个过程中，恶意的class会被实例化导致代码执行。

##### 漏洞分析

- https://blog.noah.360.net/xalan-j-integer-truncation-reproduce-cve-2022-34169/

##### 推荐工具

- https://github.com/flowerwind/AutoGenerateXalanPayload

---

### RocketMQ

#### [CVE-2019-17572(目录穿越)](https://github.com/apache/rocketmq/issues/1637)

##### 利用条件

> RocketMQ4.6.0 最新版本
>
> autoCreateTopicEnable=true默认设置

##### 漏洞说明

- 自动创建主题时存在目录穿越，可以达到任意创建新文件夹的效果。

##### 漏洞分析

- https://github.com/luelueking/Java-CVE-Lists/tree/main/CVE-2019-17572

---

### Spring-boot-Admin

#### [CVE-2022-46166(spel注入)](https://github.com/codecentric/spring-boot-admin/security/advisories/GHSA-w3x5-427h-wfq6)

##### 利用条件

> Affected versions
>
> < 2.6.10
>
> < 2.7.8
>
> < 3.0.0-M6

##### 漏洞说明

- spring-boot-admin的消息通知器中message可以执行任意spel表达式导致代码注入

##### 漏洞环境及详情

- https://github.com/luelueking/Java-CVE-Lists/tree/main/CVE-2022-46166/
